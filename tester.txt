if(
({[.]DynamicFieldTag/Field5} == '1' && {[.]DynamicFieldTag/Field4} == '1') || {[.]DynamicFieldTag/Field4} == '2' || ({[.]DynamicFieldTag/Field4} == "" && {[.]DynamicFieldTag/Field3} == '1'),"Running")




if(
{[.]DynamicFieldTag/Field5} = '1' && {[.]DynamicFieldTag/Field4} = '1' || {[.]DynamicFieldTag/Field4} = '2' || {[.]DynamicFieldTag/Field4} = "" && {[.]DynamicFieldTag/Field3} = '1',"Running")






















IF 
[~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field5 = 1 AND
([~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field4 = 1 OR
 [~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field4 = 2 OR
 [~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field4 != 0) AND
[~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field7 != "" AND
[~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field3 = 1
THEN
Machine State = "Running"

ELSE IF 
([~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field5 = 0 AND
([~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field4 = 1 OR
 [~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field4 = 2 OR
 [~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field4 != 0) AND
[~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field7 != "")
OR
([~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field5 = 1 AND
([~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field4 = 1 OR
 [~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field4 = 2 OR
 [~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field4 != 0) AND
[~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field7 != "" AND
[~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field3 = 0)
THEN
Machine State = "Down"




follow guideline-[~]McConnellsburg/Frame Fabrication/Robot Cell {cellNum}/raw/Robot {robotNum}/Field1

Alarm code: field 0
Current lamp: field 5. if value is (0)- no lamps
If value = 1. Start lamp is on
If value =2 . Held lamp is on

Job Line: field 1  (int)
Job name : field 6  (str)
Job step: field 2  (int)
Mode : field 3  (int) . If =0; "teach". If = 1 ; "play"
Part number:  field 7 (str)
Station running : field 4  (int)
If = 0; no stations running
If = 1 ; station A running
If = 2 ; station B running

-------------------------------------
Running

If

Start lamp on  -

And

Station =  A or B   or not "None"

And

Part# = Not blank

And

Mode = play

 

 

 

Down

If

Lamp  = Off

And

Station = A or B   or not "None"

AND

Part # exist

 

OR

 

If

Start lamp on  -

And

Station =  A or B   or not "None"

And

Part# = Not blank

And

Mode = TEACH



























def valueChanged(tag, tagPath, previousValue, currentValue, initialChange, missedEvents):
	value = newValue.value
	
	mapping =  {3 : "hi"}
	
	if value in mapping:
	    string_value = mapping[value]
	    
	    try:
	        system.tag.writeBlocking(paths=["[default]tester"], values=[string_value])
	    
	    except Exception as e:
	        system.gui.messageBox("Error writing to tag: %s" % e)

------------------------------
value = 3
if value == 3:
	try:
	    system.tag.writeBlocking(["[default]ReaderTag"], values=["hey"])
	except Exception as e:
	    system.gui.messageBox("Error writing to tag:%s" % e)
[Error_TypeConversion("Error trying to coerce 'hey' to a number.")]









=====================================================
value = system.tag.readBlocking(["[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field1"])[0].value

if value == 3:
	try:
	    system.tag.writeBlocking(["[default]ReaderTag"], values=["autos"])
	except Exception as e:
	    system.gui.messageBox("Error writing to tag:%s" % e)
	

def valueChanged(tag, tagPath, previousValue, currentValue, initialChange, missedEvents):
	value = system.tag.readBlocking(["[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field1"])[0].value
	print value
	if value == 3:
	    print('inside the if block')
	try:
		system.tag.writeBlocking(["[default]Robot4status"], values=["Blocked"])
	except Exception as e:
		system.gui.messageBox("Error writing to tag:%s" % e)
	
	========================================================
def valueChanged(tag, tagPath, previousValue, currentValue, initialChange, missedEvents):
    value = system.tag.readBlocking(["[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field1"])[0].value
    print value
    status = ""
    if value == 3:
        print('inside the if block for value 3')
        status = "Blocked"
    elif value == 4:
        print('inside the if block for value 4')
        status = "Running"
    elif value == 5:
        print('inside the if block for value 5')
        status = "Cool"
    else:
        print('Unexpected value')
    try:
        system.tag.writeBlocking(["[default]Robot4status"], values=[status])
    except Exception as e:
        system.gui.messageBox("Error writing to tag:%s" % e)
============================================================================
def valueChanged(tag, tagPath, previousValue, currentValue, initialChange, missedEvents):
    value = system.tag.readBlocking(["[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field1"])[0].value
    print value

    # Define a dictionary that maps values to statuses
    value_status_map = {3: "Blocked", 4: "Running", 5: "Cool"}

    # Default status for unexpected values
    status = "Unknown"

    if value in value_status_map:
        status = value_status_map[value]
        print(f'inside the if block for value {value}, status: {status}')
    else:
        print('Unexpected value')
        
    try:
        system.tag.writeBlocking(["[default]Robot4status"], values=[status])
    except Exception as e:
        system.gui.messageBox("Error writing to tag:%s" % e)
---------------
concat(
    "Alarm code: ", toString({[~]field O}),
    ", Current lamp: ", if({[~]field 5}=0, "no lamps", if({[~]field 5}=1, "Start lamp is on", "Held lamp is on")),
    ", Job Line: ", toString({[~]field 1}),
    ", Job name: ", toString({[~]field 6}),
    ", Job step: ", toString({[~]field 2}),
    ", Mode: ", if({[~]field 3}=0, "teach", "play"),
    ", Part number: ", toString({[~]field 7}),
    ", Station running: ", if({[~]field 4}=0, "no stations running", if({[~]field 4}=1, "station A running", "station B running"))
)
"Alarm code: ", toString({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4]field O}),



















------------------------------------------------------------

Running

If

Start lamp on  -

And

Station =  A or B   or not "None"

And

Part# = Not blank

And

Mode = play

 

 

 

Down

If

Lamp  = Off

And

Station = A or B   or not "None"

AND

Part # exist

 

OR

 

If

Start lamp on  -

And

Station =  A or B   or not "None"

And

Part# = Not blank

And

Mode = TEACH
concat(
    "Alarm code: ", toString({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field0}),
    ", Current lamp: ", if({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/field5}=0, "no lamps", if({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/field5}=1, "Start lamp is on", "Held lamp is on")),
        ", Job Line: ", toString({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field1}),
        ", Job name: ", toString({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field6}),
        ", Job step: ", toString({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field2}),
        ", Mode: ", if({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field3}=0, "teach", "play"),
        ", Part number: ", toString({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field7}),
        ", Station running: ", if({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field4}=0, "no stations running", if({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field4}=1, "station A running", "station B running"))

)


-----------------------------------------------------------updated-------------------------
concat(
    "Alarm code: ", toString({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field0}),
    ", Current lamp: ", if({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/field5}=0, "no lamps", if({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/field5}=1, "Start lamp is on", "Held lamp is on")),
    ", Job Line: ", toString({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field1}),
    ", Job name: ", toString({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field6}),
    ", Job step: ", toString({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field2}),
    ", Mode: ", if({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field3}=0, "teach", "play"),
    ", Part number: ", toString({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field7}),
    ", Station running: ", if({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field4}=0, "no stations running", if({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field4}=1, "station A running", "station B running")),
    ", Status: ", 
    if(
        {[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/field5}=1 
        && ({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field4}="A" || {[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field4}="B" || {[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field4}!="None") 
        && {[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field7}!="" 
        && {[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field3}=1, 
        "Running", 
        if(
            ({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/field5}=0 
            && ({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field4}="A" || {[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field4}="B" || {[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field4}!="None") 
            && {[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field7}!="") 
            || 
            ({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/field5}=1 
            && ({[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field4}="A" || {[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field4}="B" || {[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field4}!="None") 
            && {[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field7}!="" 
            && {[MQTT Engine]Edge Nodes/McConnellsburg/Frame Fabrication/Robot Cell 7/raw/Robot 4/Field3}=0), 
            "Down", 
            "Unknown"
        )
    )
)
